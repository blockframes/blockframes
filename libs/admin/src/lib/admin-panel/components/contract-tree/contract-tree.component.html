<ng-container *ngIf="loaded else spinner">
  <ul>
    <ng-template #recursiveList let-list>
      <li *ngFor="let item of list"> >
        <ng-container *ngIf="item.id === contract.id else displaywithLink">
          <strong>{{ item.id }} ({{ item.contract.type }})</strong>
          <button mat-icon-button color="accent" [routerLink]="getContractTunnelPath(item.contract)"><mat-icon svgIcon="eye"></mat-icon></button>
        </ng-container>
        <ng-template #displaywithLink>
          <a [routerLink]="getContractPath(item.id)" routerLinkActive="active"> {{ item.id }}  ({{ item.contract.type }})</a>
          <button mat-icon-button color="accent" [routerLink]="getContractTunnelPath(item.contract)"><mat-icon svgIcon="eye"></mat-icon></button>
        </ng-template>
        <ng-container *ngIf="getItems(item.id).length > 0">
          <ul>
            <ng-container [ngTemplateOutlet]="recursiveList" [ngTemplateOutletContext]="{ $implicit: getItems(item.id) }"></ng-container>
          </ul>
        </ng-container>
      </li>
    </ng-template>
    <ng-container [ngTemplateOutlet]="recursiveList" [ngTemplateOutletContext]="{ $implicit: getItems() }"></ng-container>
  </ul>
</ng-container>

<ng-template #spinner>
  <mat-spinner diameter="30"></mat-spinner>
</ng-template>