<ng-container *ngIf="offers$ | async as offers; else loading">
  <ng-container *ngIf="offers.length; else empty">

    <header fxLayout="row" fxLayoutAlign="space-between center">
      <h1>Contracts</h1>
    </header>

    <nav mat-tab-nav-bar fxLayout="row" fxLayoutAlign="space-between end">
      <button mat-tab-link>All Offers({{offers.length}})</button>
      <button mat-tab-link (click)="applyFilter('offers')" [active]="(filter$ | async) === 'offers'">Offers(1)</button>
      <button mat-tab-link (click)="applyFilter('on_going_deals')"
        [active]="(filter$ | async) === 'on_going_deals'">Ongoing Deals</button>
      <button mat-tab-link (click)="applyFilter('past_deals')" [active]="(filter$ | async) === 'past_deals'">
        Past Deals
      </button>
    </nav>

    <mat-card>
      <bf-table-filter [source]="offers | filterBy: filterByMovie: filter.value" [columns]="columns"
        [initialColumns]="initialColumns" clickable showFilter showPaginator (rowClick)="goToTitle($event)">
        <ng-template colRef="id" let-reference><b>{{ reference }}</b></ng-template>
        <ng-template colRef="date" let-date><b>{{ date.toDate()| date : 'shortDate'}}</b></ng-template>
        <ng-template colRef="contracts.length" let-length><b>{{ length }}</b></ng-template>
        <ng-template colRef="contracts" let-contracts><b>
            <ng-container *ngFor="let contract of contracts; let last=last">
              <ng-container *ngIf="contract.titleId | getTitle | async as title">
                {{title.title.international| slice:0:50}}{{last ? '': ', '}}
              </ng-container>
            </ng-container>
          </b></ng-template>
        <ng-template colRef="specificity" let-specificity><b>{{ specificity ? 'TRUE' : 'FALSE' }}</b></ng-template>
        <ng-template colRef="status" let-status><b>{{ status }}</b></ng-template>
      </bf-table-filter>
    </mat-card>
  </ng-container>
</ng-container>

<ng-template #loading>
  <mat-spinner></mat-spinner>
</ng-template>

<ng-template #empty>
  <section fxLayout="column" fxLayoutAlign="center center">
    <dashboard-no-title></dashboard-no-title>
    <article fxLayout="row" fxLayout.lt-md="column" fxLayoutAlign="center" fxLayoutGap="24px">
      <mat-card class="no-title-card" fxLayout="column" fxLayoutalign="center center">
        <img asset="empty_still_photo.png" alt="Add title">
        <a routerLink="lobby" mat-button color="primary">Add one title</a>
      </mat-card>
      <mat-card class="no-title-card" fxLayout="column">
        <img asset="add_files.webp" alt="Upload files">
        <a routerLink="../import" mat-button color="primary">Import titles in bulk</a>
      </mat-card>
    </article>
    <h3>Or</h3>
    <!-- <button (click)="openIntercom()" mat-flat-button color="primary">
      Contact the {{ appName }} team
    </button> -->
  </section>
</ng-template>
