<ng-container *ngIf="campaign$ | async as campaign">
  <h1>Financing Elements</h1>

  <!-- Budget -->
  <section id="budget" *ngIf="campaign.budget | apexBudget as options" >
    <header fxLayout fxLayoutAlign="space-between center">
      <h2>Estimated Budget</h2>
      <a mat-button [href]="campaign.files.budget" target="_blank">
        <mat-icon svgIcon="arrow_downward"></mat-icon>
        <span>Download Estimated Budget</span>
      </a>
    </header>
  
    <article fxLayout fxLayoutAlign="space-between stretch" fxLayoutGap="40px">
      <table>
        <ng-container *ngFor="let row of budgetData">
          <tr>
            <td fxLayout fxLayoutGap="8px">
              <div class="color" [style.backgroundColor]="row.color"></div>
              <span>{{ row.label }}</span>
            </td>
            <td>{{ campaign.budget[row.serie] | bigCurrency:'USD' }}</td>
          </tr>
        </ng-container>
        <tfoot>
          <tr>
            <td>Grand Total Budget</td>
            <td>{{ campaign.budget | budget | bigCurrency:'USD' }}</td>
          </tr>
        </tfoot>
      </table>

      <apx-chart
        [chart]="{ type: 'pie' }"
        [series]="options.series"
        [labels]="options.labels"
        [colors]="options.colors"
        [tooltip]="{y: formatter.bigCurrency}"
      ></apx-chart>
    </article>
    <mat-divider></mat-divider>
  </section>


  <!-- Funding -->
  <section id="budget" *ngIf="campaign.fundings | apexFunding as options">
    <header fxLayout fxLayoutAlign="space-between center">
      <h2>Financing Plan</h2>
      <a mat-button [href]="campaign.files.financingPlan" target="_blank">
        <mat-icon svgIcon="arrow_downward"></mat-icon>
        <span>Download Financing Plan</span>
      </a>
    </header>
  
    <article fxLayout fxLayoutAlign="space-between stretch" fxLayoutGap="40px">
      <table>
        <ng-container *ngFor="let funding of campaign.fundings; let i = index">
          <tr>
            <td fxLayout fxLayoutGap="8px">
              <div class="color" [style.backgroundColor]="options.colors[i]"></div>
              <span>{{ funding.name }}</span>
            </td>
            <td>{{ funding.status | titlecase }}</td>
            <td>{{ (funding.amount / (campaign.fundings | totalFundings)) | percent }}</td>
            <td>{{ funding.amount | bigCurrency:'USD' }}</td>
          </tr>
        </ng-container>
        <tfoot>
          <tr>
            <td>Total Investment</td>
            <td></td>
            <td></td>
            <td>{{ campaign.budget | budget | bigCurrency:'USD' }}</td>
          </tr>
        </tfoot>
      </table>

      <apx-chart
        [chart]="{ type: 'pie' }"
        [series]="options.series"
        [labels]="options.labels"
        [colors]="options.colors"
        [tooltip]="{y: formatter.bigCurrency}"
      ></apx-chart>
    </article>
    <mat-divider></mat-divider>
  </section>

    <!-- Profits -->
    <section id="budget" *ngIf="campaign.profits | apexProfits as options">
      <header fxLayout fxLayoutAlign="space-between center">
        <h2>Return on Investment</h2>
        <a mat-button [href]="campaign.files.waterfall" target="_blank">
          <mat-icon svgIcon="arrow_downward"></mat-icon>
          <span>Download distributed Waterfall</span>
        </a>
      </header>
    
      <article fxLayout fxLayoutAlign="space-between stretch" fxLayoutGap="40px">
        <aside>
          <h3 fxLayout fxFlayoutAlign="start center">
            <mat-icon svgIcon="info"></mat-icon>
            <span>What is the return on investment in cinema industry?</span>
          </h3>
          <p>
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Atque dolores, eius non at excepturi voluptate tenetur esse eaque maxime doloremque dolore, dignissimos dolorum repellendus maiores reprehenderit quod odio corporis iste!
          </p>
        </aside>
  
        <apx-chart
          [chart]="{ type: 'bar' }"
          [series]="options.series"
          [xaxis]="options.xAxis"
          [dataLabels]="formatter.percent"
          [tooltip]="{y: formatter.percent}"
        ></apx-chart>
      </article>
    </section>
</ng-container>