<section>
  <mat-card>
    <mat-accordion *ngIf="user$ | async as user">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
           
            <span>Personal data</span>
          </mat-panel-title>
          <mat-panel-description>
              <a routerLink="./profile">
                <mat-icon>settings</mat-icon>
              </a>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-list>
            <mat-list-item>
              <mat-card-header>
                <mat-card-title>Id</mat-card-title>
                <mat-card-subtitle>{{ user.uid }}</mat-card-subtitle>
              </mat-card-header>
            </mat-list-item>
            <mat-list-item>
              <mat-card-header>
                <mat-card-title>First Name</mat-card-title>
                <mat-card-subtitle>{{ user.firstName }}</mat-card-subtitle>
              </mat-card-header>
            </mat-list-item>
            <mat-list-item>
              <mat-card-header>
                <mat-card-title>Last Name</mat-card-title>
                <mat-card-subtitle>{{ user.lastName }}</mat-card-subtitle>
              </mat-card-header>
            </mat-list-item>
            <mat-list-item>
              <mat-card-header>
                <mat-card-title>Email</mat-card-title>
                <mat-card-subtitle>{{ user.email }}</mat-card-subtitle>
              </mat-card-header>
            </mat-list-item>
            <mat-list-item>
              <mat-card-header>
                <mat-card-title>Biography</mat-card-title>
                <mat-card-subtitle><p>{{ user.biography }}</p></mat-card-subtitle>
              </mat-card-header>
            </mat-list-item>
        </mat-list>
          
      </mat-expansion-panel>
      <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
        <mat-expansion-panel-header>
          <mat-panel-title>
            Billing
          </mat-panel-title>
          <mat-panel-description>
            Currently I am {{panelOpenState ? 'open' : 'closed'}}
          </mat-panel-description>
        </mat-expansion-panel-header>
        <p>Todo</p>
      </mat-expansion-panel>
      <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
        <mat-expansion-panel-header>
          <mat-panel-title>
            Wallet
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-list>
          <mat-list-item>
            <ng-container *ngIf="user.identity; else walletLoading">
              <mat-card-header>
                <eth-blockie mat-card-avatar [round]="false" [height]="40" width="40" [address]="user.identity.address"></eth-blockie>
                <mat-card-title>{{user.identity.domain}}</mat-card-title>
                <mat-card-subtitle>
                  <a *ngIf="network === 'homestead'; else testNet" [href]="'https://etherscan.io/address/'+user.identity.address" target="_blank" rel="noopener">{{user.identity.address}}</a>
                  <ng-template #testNet>
                    <a [href]="'https://'+network+'.etherscan.io/address/'+user.identity.address" target="_blank" rel="noopener">{{user.identity.address}}</a>
                  </ng-template>
                </mat-card-subtitle>
              </mat-card-header>
              <mat-card-content >
                <ng-container *ngIf="(notLoading$ | async); else isLoading">
                  <button mat-button matTooltip="Click to refresh" (click)="refreshBalance()">
                    {{user.balance || '0.0'}} ETH
                  </button>
                </ng-container>
                <ng-template #isLoading>
                  <button mat-button [disabled]="true">
                    <mat-spinner [diameter]="24" [strokeWidth]="2"></mat-spinner>
                  </button>
                </ng-template>
              </mat-card-content>
            </ng-container>
            <ng-template #walletLoading>
              <div class="wallet-loading">
                <p>Your Wallet is loading...</p>
                <mat-progress-bar mode="indeterminate"></mat-progress-bar>
              </div>
            </ng-template>
          </mat-list-item>
        </mat-list>
      </mat-expansion-panel>
    </mat-accordion>
  </mat-card>
</section>