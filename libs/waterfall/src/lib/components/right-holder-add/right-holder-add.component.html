<section class="surface">
  <h3>Invite Right Holder</h3>

  <article>
    <algolia-chips-autocomplete
      index="user"
      displayWithPath="email"
      [form]="form.get('users')"
      label="Right Holder Email *"
      [separators]="separators"
      placeholder="Enter guest email"
      [filters]="invitations | deepKey:'toUser.email || fromUser.email'"
      unique
      addOnBlur
      customInput
      (input)="onInputFilling($event)"
    >
      <ng-template let-user>
        <div class="profile-item">
          <img [ref]="user.avatar | storageFile: 'users':'avatar':user.uid" asset="profil_user.svg" alt="Profile">
          <span *ngIf="user.firstName">{{ user | displayUser | async }}</span>
          <span *ngIf="user.orgName">({{ user.orgName }})</span>
          <span *ngIf="!user.firstName">{{ user.email }}</span>
        </div>
      </ng-template>
    </algolia-chips-autocomplete>

    <static-select *ngIf="isProducer else notProducer" [control]="form.get('roles')" multiple scope="rightholderRoles"> 
      <mat-label>Waterfall Role *</mat-label>
    </static-select>

    <ng-template #notProducer>
      <static-select [control]="form.get('roles')" multiple scope="rightholderRoles" [only]="['producer']"> 
        <mat-label>Waterfall Role *</mat-label>
      </static-select>
    </ng-template>

    <div>
      <button mat-flat-button color="primary" [disabled]="form.invalid || (isSending$ | async)" (click)="invite()">
        <mat-icon svgIcon="send"></mat-icon>
        <span>Invite</span>
      </button>
    </div>

  </article>
</section>
