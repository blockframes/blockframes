<!-- we use class="dark-contrast-theme" to override theme style of the header because it always has a "dark" background image -->
<header class="dark-contrast-theme" bgAsset="banner_header_page.webp">
  <a mat-icon-button (click)="goBack()">
    <mat-icon svgIcon="arrow_back"></mat-icon>
  </a>
  <h1 class="mat-display-2">{{titleText}}</h1>
  <section fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="32px">

    <span class="search">
      <!-- MAIN SEARCH BAR -->
      <ng-template [ngTemplateOutlet]="pageSearchTemplate"></ng-template>
    </span>

    <span>
      <button *ngIf="canToggle" mat-icon-button (click)="listView = !listView">
        <ng-container *ngIf="!listView">
          <mat-icon matPrefix svgIcon="list"></mat-icon>
        </ng-container>
        <ng-container *ngIf="listView">
          <mat-icon matPrefix svgIcon="grid"></mat-icon>
        </ng-container>
      </button>

      <!-- SORT CONTROL-->
      <ng-template [ngTemplateOutlet]="pageSortTemplate"></ng-template>

    </span>
  </section>
</header>
<!-- FILTER SIDE CARD -->
<div fxLayout fxLayoutAlign="space-between center" class="filter dark-contrast-theme" bgAsset="banner_header_page.webp">
  <ng-content></ng-content>
</div>

<!-- Items -->
<section>
  <ng-container *ngIf="items; else loading">
    <ng-container *ngIf="items.length else empty">
      <div fxLayout="row" fxLayoutAlign="end start">
        <span i18n *ngIf="items.length as count" class="mat-body-2">
          There {count, plural, =0 {} =1 {is} other {are}} {{ count }} {{itemType}}{count, plural, =0 {} =1 {} other
          {s}} available.
        </span>
      </div>
    </ng-container>
    <ng-container *ngIf="!listView; else displayList">
      <div grid [@fadeList]="items.length">
        <ng-container *ngFor="let item of items; trackBy:trackById">
          <div class="card" [col]="3">
            <!-- INSERT CARD -->
            <ng-template [ngTemplateOutlet]="pageCardTemplate" [ngTemplateOutletContext]="{$implicit: item}">
            </ng-template>
          </div>
        </ng-container>
      </div>
    </ng-container>
    <ng-template #displayList>
      <div>
        <ng-container *ngFor="let item of items">

          <!-- INSERT LIST ITEM -->
          <ng-template [ngTemplateOutlet]="pageListItemTemplate" [ngTemplateOutletContext]="{$implicit: item}">
          </ng-template>

        </ng-container>
      </div>
    </ng-template>
    <!-- PROGRESS -->
    <ng-template [ngTemplateOutlet]="pageProgressTemplate || loadMoreButton">
    </ng-template>
    <ng-template #loadMoreButton>
      <div fxLayout="column" fxLayoutAlign="center center" *ngIf="nbHits">
        <div class="progress">
          You've viewed {{ hitsViewed }} of {{ nbHits }} {{itemType}}{nbHits, plural, =0 {} =1 {} other
          {s}}
          <mat-progress-bar color="primary" [value]="hitsViewed / nbHits * 100"></mat-progress-bar>
        </div>
        <ng-container *ngIf="hitsViewed !== nbHits">
          <button mat-stroked-button color="primary" (click)="loadMore.emit()">LOAD MORE</button>
        </ng-container>
      </div>
    </ng-template>
  </ng-container>
  <ng-template #loading>
    <div fxLayout fxLayoutAlign="center center">
      <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
    </div>
  </ng-template>
  <ng-template #empty>
    <div fxLayout="column" fxLayoutAlign="start center">
      <h6>There is no corresponding title.</h6>
      <img asset="no_titles.webp" alt="No titles">
    </div>
  </ng-template>

</section>