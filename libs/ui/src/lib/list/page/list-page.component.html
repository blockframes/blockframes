<!-- we use class="dark-contrast-theme" to override theme style of the header because it always has a "dark" background image -->
<header class="dark-contrast-theme" bgAsset="banner_header_page.webp">
  <a mat-icon-button (click)="goBack()">
    <mat-icon svgIcon="arrow_back"></mat-icon>
  </a>
  <ng-template [ngTemplateOutlet]="pageTitleTemplate"></ng-template>
  <section fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="32px">

    <span class="search">
      <!-- MAIN SEARCH BAR -->
      <ng-template [ngTemplateOutlet]="pageSearchTemplate"></ng-template>
    </span>

    <span>
      <button *ngIf="canToggle" mat-icon-button (click)="listView = !listView">
        <ng-container *ngIf="!listView">
          <mat-icon matPrefix svgIcon="list"></mat-icon>
        </ng-container>
        <ng-container *ngIf="listView">
          <mat-icon matPrefix svgIcon="grid"></mat-icon>
        </ng-container>
      </button>

      <!-- SORT CONTROL-->
      <ng-template [ngTemplateOutlet]="pageSortTemplate"></ng-template>

    </span>
  </section>
</header>

<!-- FILTER SIDE CARD -->
<div fxLayout fxLayoutAlign="space-between center" class="filter dark-contrast-theme" bgAsset="banner_header_page.webp">
  <ng-content></ng-content>
</div>

<!-- Items -->
<section>
  <ng-container *ngIf="items; else loading">
    <div fxLayout="row" fxLayoutAlign="end start">
      <ng-template [ngTemplateOutlet]="pageResultDescriptionTemplate"></ng-template>
    </div>
    <ng-container *ngIf="!listView; else displayList">
      <div grid [@fadeList]="items.length">
        <ng-container *ngFor="let item of items; trackBy:trackById">
          <div class="card" [col]="3">

            <!-- INSERT CARD -->
            <ng-template [ngTemplateOutlet]="pageCardTemplate" [ngTemplateOutletContext]="{$implicit: item}">
            </ng-template>
          </div>
        </ng-container>
      </div>
    </ng-container>
    <ng-template #displayList>
      <div>
        <ng-container *ngFor="let item of items">

          <!-- INSERT LIST ITEM -->
          <ng-template [ngTemplateOutlet]="pageListItemTemplate" [ngTemplateOutletContext]="{$implicit: item}">
          </ng-template>

        </ng-container>
      </div>
    </ng-template>

    <!-- PROGRESS -->
    <ng-template [ngTemplateOutlet]="pageProgressTemplate"></ng-template>
  </ng-container>
  <ng-template #loading>
    <div fxLayout fxLayoutAlign="center center">
      <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
    </div>
  </ng-template>

</section>