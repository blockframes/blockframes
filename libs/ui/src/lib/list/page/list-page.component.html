<!-- we use class="dark-contrast-theme" to override theme style of the header because it always has a "dark" background image -->
<header class="dark-contrast-theme" bgAsset="banner_header_page.webp">
  <a mat-icon-button (click)="goBack()">
    <mat-icon svgIcon="arrow_back"></mat-icon>
  </a>
  <ng-content select="page-title"></ng-content>
  <section fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="32px">

    <div class="search">
      <!-- MAIN SEARCH BAR -->
      <ng-content select="page-search"></ng-content>
    </div>

    <button *ngIf="canToggle" mat-icon-button (click)="listView = !listView">
      <ng-container *ngIf="!listView">
        <mat-icon matPrefix svgIcon="list"></mat-icon>
      </ng-container>
      <ng-container *ngIf="listView">
        <mat-icon matPrefix svgIcon="grid"></mat-icon>
      </ng-container>
    </button>

    <!-- SORT CONTROL-->
    <ng-content select="page-sort"></ng-content>

  </section>
</header>

<!-- FILTER SIDE CARD -->
<div fxLayout fxLayoutAlign="space-between center" class="filter dark-contrast-theme" bgAsset="banner_header_page.webp">
  <ng-content></ng-content>
</div>

<!-- Items -->
<section>
  <ng-container *ngIf="items.length; else empty">
    <div fxLayout="row" fxLayoutAlign="end start">
      <ng-content select="page-description"></ng-content>
    </div>
    <ng-container *ngIf="!listView; else displayList">
      <div grid [@fadeList]="items.length">
        <ng-container *ngFor="let item of items; trackBy:trackById">
          <div [col]="3">

            <!-- INSERT CARD -->
            <ng-template [ngTemplateOutlet]="pageCardTemplate" [ngTemplateOutletContext]="{$implicit: item}">
            </ng-template>
          </div>
        </ng-container>
      </div>
    </ng-container>
    <ng-template #displayList>
      <div *ngFor="let item of items">

        <!-- INSERT LIST ITEM -->
        <ng-template [ngTemplateOutlet]="pageListItemTemplate" [ngTemplateOutletContext]="{$implicit: item}">
        </ng-template>

      </div>
    </ng-template>

  </ng-container>

  <!-- PROGRESS -->
  <ng-content select="page-progress"></ng-content>

  <!-- ERROR HANDLING -->
  <ng-template #empty>
    <ng-template [ngTemplateOutlet]="pageErrorTemplate || defaultImg"></ng-template>
    <ng-template #defaultImg>
      <div fxLayout="column" fxLayoutAlign="start center">
        <h6>We didn't found anything.</h6>
        <img asset="no_titles.webp" alt="No titles">
      </div>
    </ng-template>
  </ng-template>
</section>