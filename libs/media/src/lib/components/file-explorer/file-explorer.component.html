<article fxLayout>

    <aside>
      <mat-selection-list [multiple]="false">
        <mat-list-option
          *ngFor="let directory of directories; let first = first; let index = index"
          [selected]="index === activeDirectory.path[0]"
          [ngClass]="index === activeDirectory.path[0] ? 'selected' : 'not-selected'"
          (click)="goTo(directory.path)"
        >
          <mat-icon mat-list-icon [svgIcon]="first ? 'home' : 'film'"></mat-icon>
          <span mat-line>{{ directory.name | maxLength: 20}}</span>
        </mat-list-option>
      </mat-selection-list>
    </aside>

    <section class="surface">

      <header fxLayout fxLayoutAlign="space-between center">

        <div fxLayout="row wrap" fxLayoutAlign="start center">
          <ng-container *ngFor="let crumb of breadCrumbs; let isLast = last">
            <button mat-button color="primary" (click)="goTo(crumb.path)">{{ crumb.name }}</button>
            <span *ngIf="!isLast">></span>
          </ng-container>
        </div>

        <ng-container *ngIf="activeDirectory.type !== 'directory' && activeDirectory.multiple">
          <button mat-stroked-button color="primary" (click)="openDialog()">
            <mat-icon svgIcon="add"></mat-icon>
            <span>Upload file</span>
          </button>
        </ng-container>

      </header>

      <ng-container *ngIf="breadCrumbs.length > 1">
        <button mat-icon-button (click)="goTo(breadCrumbs[breadCrumbs.length - 2].path)" matTooltip="Navigate back one step">
          <mat-icon svgIcon="arrow_back"></mat-icon>
        </button>
      </ng-container>

      <mat-divider></mat-divider>

      <ng-container *ngIf="activeDirectory.type === 'directory' else fileDirectory">
        <mat-selection-list [multiple]="false">
          <mat-list-option *ngFor="let directory of activeDirectory.directories" (click)="goTo(directory.path)" >
            <mat-icon *ngIf="directory.type === 'directory' || directory.multiple" mat-list-icon svgIcon="folder"></mat-icon>
            <mat-icon *ngIf="directory.type === 'file' && !directory.multiple" mat-list-icon svgIcon="document"></mat-icon>
            <mat-icon *ngIf="directory.type === 'image' && !directory.multiple" mat-list-icon svgIcon="picture"></mat-icon>
            <span mat-line>{{ directory.name }}</span>
          </mat-list-option>
        </mat-selection-list>
      </ng-container>

      <ng-template #fileDirectory>

        <ng-container *ngIf="activeDirectory.type !== 'directory' && activeDirectory.multiple else single">
          <file-explorer-multiple-files-view
            [activeDirectory]="activeDirectory"
            (editFile)="openDialog($event)">
          </file-explorer-multiple-files-view>
        </ng-container>

        <ng-template #single>
          <file-explorer-single-file-view [activeDirectory]="activeDirectory">
          </file-explorer-single-file-view>
        </ng-template>

      </ng-template>
    </section>

  </article>
