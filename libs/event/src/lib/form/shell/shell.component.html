<ng-template #confirmExit>
  <div class="confirm-exit" fxLayout="column" fxLayoutAlign="start center" fxLayoutGap="16px">
    <h1>You are about to leave the form.</h1>
    <p>Some changes have not been saved.<br/>If you leave now, you will lose these changes.</p>
    <div fxLayout="column" fxLayoutAlign="center">
      <button class="save" mat-flat-button color="primary" [mat-dialog-close]="true">
        Save & Exit</button>
      <button class="text-primary" mat-button [mat-dialog-close]="false">
        Close without saving
      </button>
    </div>
  </div>
</ng-template>

<ng-container *ngIf="form">
  <ng-template pageBar>
    <header fxLayout fxLayoutAlign="space-between center">
      <div fxLayout fxLayoutGap="40px">
        <a mat-icon-button routerLink="../..">
          <mat-icon svgIcon="arrow_back"></mat-icon>
        </a>
        <mat-chip-list fxLayoutAlign="center center">
          <mat-chip disableRipple *ngIf="screenerMissing">
            <mat-icon svgIcon="warning"></mat-icon>
            <span>Screening file missing</span>
          </mat-chip>
        </mat-chip-list>
      </div>
      <div fxLayout fxLayoutAlign="end center">
        <button type="button" mat-button color="warn" (click)="remove()">Delete</button>
        <ng-container *ngIf="form.dirty else disabled">
          <button type="submit" mat-stroked-button color="primary" (click)="save()" test-id="event-save">Save</button>
        </ng-container>
        <ng-template #disabled>
          <button mat-button disabled>Save</button>
        </ng-template>
      </div>
    </header>
  </ng-template>

  <form [formGroup]="form">
    <mat-card>
      <h2>Details</h2>
      <event-details-edit [form]="form" showPrivacy></event-details-edit>
    </mat-card>

    <nav mat-tab-nav-bar>
      <ng-container *ngFor="let tab of (tabs$ |async)"> 
        <a mat-tab-link 
        [routerLink]="tab.path" 
        routerLinkActive 
        #rla="routerLinkActive"
        [active]="rla.isActive">
        {{ tab.label }}</a>
      </ng-container>
    </nav>
  </form>

  <div class="routerContainer" [@routeAnimation]="animationOutlet(outlet)">
    <router-outlet #outlet="outlet"></router-outlet> 
  </div>

  <a class="goToEvent" mat-button mat-flat-button color="primary" [routerLink]="internalLink">Go to Event Page</a>
</ng-container>
