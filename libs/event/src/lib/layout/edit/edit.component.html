<ng-template pageBar>
  <header fxLayout fxLayoutAlign="space-between center">
    <a mat-icon-button routerLink="../..">
      <mat-icon svgIcon="arrow_back"></mat-icon>
    </a>
    <div fxLayout fxLayoutAlign="end center">
      <button type="button" mat-button color="warn" (click)="remove()">Delete</button>
      <ng-container *ngIf="form.dirty else disabled">
        <button type="submit" mat-stroked-button color="primary" (click)="save()" test-id="event-save">Save</button>
      </ng-container>
      <ng-template #disabled>
        <button mat-button disabled>Save</button>
      </ng-template>
    </div>
  </header>
</ng-template>

<form [formGroup]="form">
  <section fxLayout="column" fxLayoutGap="24px">
    <a fxFlexAlign="center" mat-stroked-button color="primary" [routerLink]="eventLink">Go to Event Page</a>
    <h2>Details</h2>
    <mat-card class="details" fxLayout="column" fxFlex="65">
      <mat-form-field appearance="outline">
        <mat-label>Event Title</mat-label>
        <input matInput formControlName="title" test-id="event-title" />
      </mat-form-field>

      <div fxLayout fxLayoutAlign="space-between center" fxLayoutGap="24px">
        <mat-form-field fxFlex appearance="outline" test-id="event-start">
          <mat-label>Start</mat-label>
          <time-picker formControlName="start" [allDay]="form.value.allDay" (change)="onEventChange('start')"></time-picker>
        </mat-form-field>
        <span>to</span>
        <mat-form-field fxFlex  appearance="outline" test-id="event-end">
          <mat-label>End</mat-label>
          <time-picker formControlName="end" [allDay]="form.value.allDay" (change)="onEventChange('end')"></time-picker>
        </mat-form-field>
      </div>

      <mat-slide-toggle test-id="all-day" formControlName="allDay" color="primary">All day</mat-slide-toggle>

      <mat-radio-group formControlName="privacy" aria-label="Choose privacy" fxLayout fxLayoutAlign="start center">
        <mat-radio-button value="public">Public</mat-radio-button><mat-icon svgIcon="info" matTooltip="Event is listed on the marketplace and available to all users."></mat-icon>
        <mat-radio-button value="private">Private</mat-radio-button><mat-icon svgIcon="info" matTooltip="Event is listed on the marketplace but only invited users can join."></mat-icon>
        <!-- <mat-radio-button value="secret">Secret</mat-radio-button><mat-icon svgIcon="info" matTooltip="Event is not listed on the marketplace. Only invited users can join"></mat-icon> -->
      </mat-radio-group>
    </mat-card>

    <!-- Meta content -->
    <ng-content></ng-content>


    <h2>Invitations</h2>
    <mat-card class="invitations" fxLayout="column"  fxFlex="35">
      <invitation-form-user [eventId]="form.value.id" [invitations]="invitations"></invitation-form-user>
      <invitation-guest-list [invitations]="invitations"></invitation-guest-list>
    </mat-card>
  </section>
</form>
