<article fxLayout="column" fxLayoutAlign="center">
  <section fxLayout="column" fxLayoutAlign="center center">
    <h1>Add your titles using the Archipel Content Excel template</h1>

    <div fxLayout="column" fxLayoutAlign="center">
      <button mat-stroked-button color="primary" (click)="downloadTemplate('movie')">
        <mat-icon>cloud_upload</mat-icon><span>Download our template to import in bulk</span>
      </button>
      <ng-container *ngIf="isUserBlockframesAdmin">
        <button mat-stroked-button color="primary" (click)="downloadTemplate('deals')">
          <mat-icon>cloud_upload</mat-icon><span>Download our excel deals template</span>
        </button>
        <button mat-stroked-button color="primary" (click)="downloadTemplate('contracts')">
          <mat-icon>cloud_upload</mat-icon><span>Download our excel contracts template</span>
        </button>
      </ng-container>
    </div>
  </section>

  <section fxLayout="row" fxLayoutAlign="center center" *ngIf="isUserBlockframesAdmin">
    <mat-form-field appearance="outline">
      <mat-label>Select import type</mat-label>
      <mat-select [formControl]="fileType">
        <mat-option value="movies">Movies</mat-option>
        <mat-option value="deals">Deals</mat-option>
        <mat-option value="contracts">Contracts</mat-option>
      </mat-select>
    </mat-form-field>
  </section>

  <section class="help-section" fxLayout="column" fxLayoutAlign="center center">
    <p>Once you have filled it out, please upload it below.</p>
    <a [routerLink]="['./']" (click)="openIntercom()">Need help ?</a>
  </section>
  <section fxLayout="column" fxLayoutAlign="center center">
    <ng-container *ngIf="sheets.length; else fileUpload">
      <span><mat-icon>attachment</mat-icon> File uploaded, click on "Start import" to continue!</span>
    </ng-container>
    <ng-template #fileUpload>
      <file-upload accept="['.xls', '.xlsx', '.ods', '.csv']" [types]="[
          'application/vnd.ms-excel',
          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
          'application/vnd.oasis.opendocument.spreadsheet',
          'text/csv']" (uploaded)="importSpreadsheet($event)"></file-upload>
    </ng-template>
  </section>

  <section fxLayout="column" fxLayoutAlign="center center">
    <img asset="Upload_380.png">
    <!-- TODO #1387 -->
    <section fxLayout="row" fxLayoutAlign="end center">
      <ng-container *ngIf="sheets.length">
        <button mat-flat-button color="warn" (click)="removeFile()">
          <mat-icon>delete_circle</mat-icon>
        </button>
        <button mat-flat-button color="primary" (click)="previewFile()" *ngIf="isUserBlockframesAdmin">
          <mat-icon>open_in_new</mat-icon>
        </button>
      </ng-container>
      <button mat-flat-button color="primary" (click)="next()" [disabled]="sheets.length === 0">Start import
        <mat-icon>arrow_downward</mat-icon></button>
    </section>
  </section>
</article>
