<form page-id="movie-form-main" [formGroup]="main">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Content Type</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <article fxLayout="column">

        <!-- CONTENT TYPE -->
        <mat-form-field appearance="outline">
          <mat-label>Content Type</mat-label>
          <mat-select formControlName="workType">
            <mat-option value="movie">Movie</mat-option>
            <mat-option value="short">Short</mat-option>
            <mat-option value="serie">Serie</mat-option>
            <mat-option value="season">Season</mat-option>
            <mat-option value="volume">Volume</mat-option>
            <mat-option value="episode">Episode</mat-option>
            <mat-option value="collection">Collection</mat-option>
            <mat-option value="tv_film">TV Film</mat-option>
            <mat-option value="flow">Flow</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- FRESHNESS -->
        <div formGroupName="storeConfig" fxLayout="column">
          <mat-form-field appearance="outline">
            <mat-label>Freshness</mat-label>
            <mat-select formControlName="storeType">
              <mat-option value="catalog">Catalog</mat-option>
              <mat-option value="line_up">Line-Up</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- PRODUCTION STATUS -->
        <mat-form-field appearance="outline">
          <mat-label>Production Status</mat-label>
          <mat-select formControlName="status" required>
            <mat-option *ngFor="let status of staticModels.MOVIE_STATUS" [value]="status.slug">
              {{ status.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- TITLES -->
        <article formGroupName="title" fxLayout="column">
          <mat-form-field appearance="outline">
            <mat-label>International title</mat-label>
            <input matInput type="text" placeholder="International title" formControlName="international" required />
            <mat-error *ngIf="main.title.get('international').hasError('required')">
              International title is <b>required</b>
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Original title</mat-label>
            <input test-id="movie-add" matInput type="text" placeholder="Original title" formControlName="original" required />
            <mat-error *ngIf="main.title.get('original').hasError('required')">
              Original title is <b>required</b>
            </mat-error>
          </mat-form-field>
        </article>

        <article fxLayout="column">
          <mat-form-field appearance="outline">
            <mat-label>Reference</mat-label>
            <input matInput type="text" placeholder="Reference" formControlName="internalRef" />
            <mat-hint>This reference is for you only</mat-hint>
          </mat-form-field>
        </article>

      </article>
    </mat-card-content>
  </mat-card>

  <mat-card>
    <mat-card-header>
      <mat-card-title>Director(s)</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <!-- DIRECTORS -->
      <article formArrayName="directors" *ngFor="let director of main.directors.controls; let i = index;">
        <div [formGroupName]="i" fxLayout="column">
          <mat-form-field appearance="outline">
            <mat-label>Director's Firstname</mat-label>
            <input matInput formControlName="firstName" placeholder="ex. Woody" required>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Director's Lastname</mat-label>
            <input matInput formControlName="lastName" placeholder="ex. Allen" required>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Director's Filmography</mat-label>
            <textarea matInput formControlName="shortBiography" placeholder="Director's Filmography"></textarea>
            <mat-hint>Selective filmography to present the director</mat-hint>
          </mat-form-field>
        </div>

        <mat-divider inset="true"></mat-divider>

      </article>

      <article fxLayout="column" fxLayoutAlign="center center">
        <button mat-mini-fab color="primary" (click)="main.addDirector()">
          <mat-icon>add</mat-icon>
        </button>
        <p>Add an other director</p>
      </article>
    </mat-card-content>
  </mat-card>

  <mat-card>
    <mat-card-header>
      <mat-card-title>Country(ies) of Origin</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <article formArrayName="originCountries" *ngFor="let country of main.originCountries.controls; let i = index" fxLayout="column">

        <!-- COUNTRIES OF ORIGIN -->
        <mat-form-field appearance="outline">
          <mat-label>Country of Origin</mat-label>
          <input matInput [formControlName]="i" placeholder="Country of Origin" [matAutocomplete]="originCountries" required>

          <mat-autocomplete #originCountries="matAutocomplete">
            <mat-option *ngFor="let country of countries$ | async" [value]="country.slug">
              {{ country.label }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <!-- DISTRIBUTOR OF COUNTRY OF ORIGIN -->
        <!-- TODO #1478 Data model/UI : Distributor of country of origin doesn't exist yet-->
        <!-- <mat-form-field appearance="outline">
          <mat-label>Domestic Distributor</mat-label>
          <input matInput formControlName="originDistributor" placeholder="Domestic Distributor">
        </mat-form-field> -->
      </article>

      <article fxLayout="column" fxLayoutAlign="center center">
        <button mat-mini-fab color="primary" (click)="main.addOriginCountry()">
          <mat-icon>add</mat-icon>
        </button>
        <span>Add an other country</span>
      </article>

      <mat-divider inset="true"></mat-divider>

      <article fxLayout="column">
        <!-- ORIGINAL LANGUAGES -->
        <mat-form-field appearance="outline">
          <mat-label>Original Language</mat-label>
          <mat-select formControlName="languages" placeholder="Film Languages" multiple required>
            <mat-option>
              <ngx-mat-select-search [formControl]="languagesFilterCtrl" [placeholderLabel]="'Choose a language'"
                [noEntriesFoundLabel]="'No matching language found'"></ngx-mat-select-search>
            </mat-option>
            <mat-option *ngFor="let language of languages$ | async" [value]="language.slug">
              {{ language.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </article>
    </mat-card-content>
  </mat-card>

  <mat-card>
    <mat-card-header>
      <mat-card-title>Genre</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <article fxLayout="column">
        <!-- GENRES -->
        <mat-form-field appearance="outline">
          <mat-select formControlName="genres" placeholder="Genres" multiple required>
            <mat-option>
              <ngx-mat-select-search [formControl]="genresFilterCtrl" [placeholderLabel]="'Genre'"
                [noEntriesFoundLabel]="'No matching genre found'"></ngx-mat-select-search>
            </mat-option>
            <mat-option *ngFor="let genre of genres$ | async" [value]="genre.slug">
              {{ genre.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- IF OTHER SPECIFY -->
        <!-- TODO #1478 Data model/UI : Specify genre must be in a specific new array -->
        <!-- <mat-form-field appearance="outline">
          <mat-label>Specify</mat-label>
          <input matInput formControlName="genres" placeholder="Specify">
        </mat-form-field> -->
      </article>

      <!-- <article fxLayout="column" fxLayoutAlign="center center">
        <button mat-mini-fab color="primary" (click)="main.addGenres()">
          <mat-icon>add</mat-icon>
        </button>
        <span>Add an other genre</span>
      </article> -->

      <mat-divider inset="true"></mat-divider>

      <article fxLayout="column">
        <!-- TOTAL RUNTIME -->
        <mat-form-field appearance="outline">
          <mat-label>Running Time</mat-label>
          <input matInput formControlName="totalRunTime" placeholder="Running Time" required>
          <mat-hint>In minutes</mat-hint>
        </mat-form-field>

        <!-- PRINCIPAL CAST -->
        <!-- <mat-form-field appearance="outline">
          <mat-label>Principal Cast Member(s)</mat-label>
          <input matInput formControlName="castMember" placeholder="Principal Cast Member" required>
        </mat-form-field> -->
      </article>
    </mat-card-content>
  </mat-card>
</form>
