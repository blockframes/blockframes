<section *ngIf="(orgs$ | async) as orgs">
  <ng-container *ngIf="orgs.length > 0; else empty">
    <mat-expansion-panel
      *ngFor="let org of orgs"
      [expanded]="true"
      class="mat-elevation-z0"
    >
      <mat-expansion-panel-header>
        <mat-panel-title fxLayout="row wrap" fxLayoutAlign="space-between center">
          <span class="organization">
            {{ org.name }}
          </span>
          <div class="divider"></div>
          <div class="icon-container">
            <mat-icon class="view-icon" color="primary">view_quilt</mat-icon>
          </div>
          <div class="icon-container">
            <mat-icon class="view-icon" color="primary">view_module</mat-icon>
          </div>
          <button
            mat-raised-button
            (click)="addNewMovie($event, { id: org.id, name: org.name })"
            class="add-movie mat-elevation-z0"
          >
            Create a movie <mat-icon class="add-icon">add</mat-icon>
          </button>
        </mat-panel-title>
      </mat-expansion-panel-header>
      <article class="movie-list-container" fxLayout="row wrap" fxLayoutAlign="start space-between">
        <mat-card *ngFor="let movie of org.movies" class="movie-card">
          <div class="img-container clickable-item">
            <ng-container *ngIf="movie.poster; else defaultPoster">
              <a [routerLink]="['/layout/with-org-segment', movie.id]">
                <img
                  mat-card-image
                  [src]="movie.poster"
                  alt="Movie poster link"
                />
              </a>
            </ng-container>
            <ng-template #defaultPoster>
              <a [routerLink]="['/layout/with-org-segment', movie.id]">
                <img
                  class="mat-card-image"
                  src="/assets/images/default-movie-poster.png"
                  alt="Movie poster link"
                />
              </a>
            </ng-template>

            <button mat-icon-button [matMenuTriggerFor]="menu">
              <mat-icon color="primary">more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu" xPosition="before">
              <button mat-menu-item [matMenuTriggerFor]="subMenu">
                <mat-icon color="primary">control_camera</mat-icon>
                <span>Open in...</span>
              </button>
              <a mat-menu-item [routerLink]="[movie.id, 'edit']">
                <mat-icon color="primary">edit</mat-icon>
                <span>Edit</span>
              </a>
              <button mat-menu-item (click)="delete(movie.id)">
                <mat-icon color="primary">delete_outline</mat-icon>
                <span>Delete</span>
              </button>
            </mat-menu>
            <mat-menu #subMenu="matMenu">
              <a mat-menu-item [routerLink]="[movie.id]">Explorer</a>
            </mat-menu>
          </div>
          <a [routerLink]="['/layout/with-org-segment', movie.id, 'list']">
            <mat-card-header class="clickable-item">
              <mat-card-title>
                {{ movie.title.original}}
                <span *ngIf="movie.productionYear"> ({{ movie.productionYear }})</span>
              </mat-card-title>
              <mat-card-subtitle *ngIf="movie.directorName">{{ movie.directorName }}</mat-card-subtitle>
            </mat-card-header>
          </a>
        </mat-card>
      </article>
      <movie-empty *ngIf="org.movies.length < 1"></movie-empty>
    </mat-expansion-panel>
  </ng-container>
  <ng-template #empty>
    <movie-home-empty></movie-home-empty>
  </ng-template>
</section>




