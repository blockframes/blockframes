<tunnel-page>
  <ng-container tunnel-form>
    <h4 title>END</h4>
    <h1 subtitle>Summary Page</h1>
    <p description class="mat-body-1">
      Please verify that all the information you have entered is correct before submitting to Archipel Content for validation.
    </p>

    <section id="main-information">
      <h3>Main Information</h3>
      <article>
        <h5>
          Reference
          <a mat-icon-button [routerLink]="getPath('main')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <strong>International Title </strong>
            <missing-control [control]="title.get('international')" [link]="getPath('main')"></missing-control>
          </li>
          <li>
            <strong>Original Title </strong>
            <missing-control [control]="title.get('original')" [link]="getPath('main')"></missing-control>
          </li>
          <li>
            <strong>Content Type </strong>
            <missing-control [control]="form.get('contentType')" [link]="getPath('main')">
              <ng-template #content>
                {{ form.get('contentType').value | toLabel: 'contentType' | async | titlecase }}
              </ng-template>
            </missing-control>
          </li>
          <li>
            <strong>Title Reference </strong>
            <missing-control [control]="form.get('internalRef')" [link]="getPath('main')"></missing-control>
          </li>
        </ul>
      </article>
      <article>
        <h5>
          Images
          <a mat-icon-button [routerLink]="getPath('main')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <mat-icon svgIcon="eye" color="primary"></mat-icon><strong>Film Page Banner Image </strong>
            <ng-container *ngIf="(form.banner.get('media').value | isEmptyImgRef) else banner">
              <a [routerLink]="getPath('main')" class="missing-control">
                Missing
              </a>
            </ng-container>
            <ng-template #banner>
              <a [href]="form.banner.get('media').value.url" target="_blank">
                {{ form.banner.get('media').value | fileName }}
              </a>
            </ng-template>
          </li>
          <li>
            <mat-icon svgIcon="eye" color="primary"></mat-icon><strong>Poster Image </strong>
            <ng-container *ngIf="(form.poster.get('media').value | isEmptyImgRef) else poster">
              <a [routerLink]="getPath('main')" class="missing-control">
                Missing
              </a>
            </ng-container>
            <ng-template #poster>
              <a [href]="form.poster.get('media').value.url" target="_blank">
                {{ form.poster.get('media').value | fileName }}
              </a>
            </ng-template>
          </li>
        </ul>
      </article>
      <article>
        <h5>
          General Information
          <a mat-icon-button [routerLink]="getPath('main')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <strong>Release Date </strong>
            <missing-control [control]="form.release.get('year')" [link]="getPath('main')"></missing-control>
          </li>
          <li>
            <strong>Countries of origin </strong>
            <ng-container *ngFor="let country of form.originCountries.controls; let isLast = last">
              <missing-control [control]="country" scope="TERRITORIES" [link]="getPath('main')" [isLast]="isLast"></missing-control>
            </ng-container>
          </li>
          <li>
            <strong>Original Language </strong>
            <ng-container *ngFor="let language of form.originalLanguages.controls; let isLast = last">
              <missing-control [control]="language" scope="LANGUAGES" [link]="getPath('main')" [isLast]="isLast"></missing-control>
            </ng-container>
          </li>
          <li>
            <strong>Genres </strong>
            <ng-container *ngFor="let genre of genres; let isLast = last">
              <ng-container *ngIf="!isLast else last">
                <missing-control [control]="genre" scope="GENRES" [link]="getPath('main')" [isLast]="isLast"></missing-control>
              </ng-container>
              <ng-template #last>
                {{ genre.value }}
              </ng-template>
            </ng-container>
          </li>
          <li>
            <strong>Running Time </strong>
            <missing-control [control]="form.runningTime" [link]="getPath('main')">
              <ng-template #content>{{ form.runningTime.get('time').value | duration }}</ng-template>
            </missing-control>
          </li>
        </ul>
      </article>
      <article>
        <h5>
          Directors
          <a mat-icon-button [routerLink]="getPath('main')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let director of form.directors.controls">
            <li>
              <strong>Director Name </strong>
              <ng-container *ngIf="directorHasErrorRequired(director) else display">
                <a [routerLink]="getPath('main')" class="mandatory-control">
                  Mandatory
                </a>
              </ng-container>
              <ng-template #display>
                <missing-control [control]="director.get('firstName')" [link]="getPath('main')" isLast=false></missing-control>
                <missing-control [control]="director.get('lastName')" [link]="getPath('main')"></missing-control>
              </ng-template>
            </li>
            <li>
              <strong>Director's Filmography </strong><missing-control [control]="director.get('filmography')" [link]="getPath('main')"></missing-control>
            </li>
          </ng-container>
        </ul>
      </article>
    </section>

    <mat-divider></mat-divider>

    <section id="storyline-elements">
      <h3>Storyline Elements</h3>
      <article>
        <h5>
          Logline
          <a mat-icon-button [routerLink]="getPath('synopsis')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <missing-control [control]="form.get('logline')" [link]="getPath('synopsis')"></missing-control>
          </li>
        </ul>
      </article>
      <article>
        <h5>
          Synopsis
          <a mat-icon-button [routerLink]="getPath('synopsis')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <missing-control [control]="form.get('synopsis')" [link]="getPath('synopsis')"></missing-control>
          </li>
        </ul>
      </article>
      <article>
        <h5>
          Key Assets
          <a mat-icon-button [routerLink]="getPath('synopsis')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <missing-control [control]="form.get('keyAssets')" [link]="getPath('synopsis')"></missing-control>
          </li>
        </ul>
      </article>
      <article>
        <h5>
          Keywords
          <a mat-icon-button [routerLink]="getPath('synopsis')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <li>
            <mat-chip-list fxLayout="row" fxLayoutGap="5px">
              <ng-container *ngIf="!form.get('keywords').value.length else display">
                <a [routerLink]="getPath('synopsis')" class="missing-control">
                  Missing
                </a>
              </ng-container>
              <ng-template #display>
                <ng-container *ngFor="let keyword of form.get('keywords').value">
                  <mat-chip>
                    {{ keyword }}
                  </mat-chip>
                </ng-container>
              </ng-template>
            </mat-chip-list>
          </li>
        </ul>
      </article>
    </section>

    <mat-divider></mat-divider>

    <section id="production-information">
      <h3>Production Information</h3>
      <article>
        <h5>
          Production Companies
          <a mat-icon-button [routerLink]="getPath('production')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let producer of form.stakeholders.get('productionCompany').controls; let isLast = last">
            <missing-control [control]="producer.get('displayName')" [link]="getPath('production')"></missing-control>
            <ng-container *ngIf="producer.get('countries').value.length">
              <span> (</span>
              <span *ngFor="let country of producer.get('countries').value; let last = last">
                <span>{{ country | translateSlug: 'TERRITORIES' }}{{ last ? '' : ', '}}</span>
              </span>
              <span>)</span>
            </ng-container>
            <span>{{ isLast ? '' : ', '}}</span>
          </ng-container>
        </ul>
      </article>

      <article>
        <h5>Co-production Companies
          <a mat-icon-button [routerLink]="getPath('production')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let coProducer of form.stakeholders.get('coProductionCompany').controls; let isLast = last">
            <missing-control [control]="coProducer.get('displayName')" [link]="getPath('production')"></missing-control>
            <ng-container *ngIf="coProducer.get('countries').value.length">
              <span> (</span>
              <ng-container *ngFor="let country of coProducer.get('countries').value; let last = last">
                <span>{{ country | translateSlug: 'TERRITORIES' }}{{ last ? '' : ', '}}</span>
              </ng-container>
              <span>)</span>
            </ng-container>
            <span>{{ isLast ? '' : ', '}}</span>
          </ng-container>
        </ul>
      </article>

      <article>
        <h5>
          Producers
          <a mat-icon-button [routerLink]="getPath('production')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let producer of form.producers.controls; let isLast = last">
            <ng-container *ngIf="producerHasNoValue(producer) else displayProducer">
              <a [routerLink]="getPath('production')" class="missing-control">
                Missing
              </a>
            </ng-container>
            <ng-template #displayProducer>
              <missing-control [control]="producer.get('firstName')" [link]="getPath('production')"></missing-control>
              <span>&nbsp;</span>
              <missing-control [control]="producer.get('lastName')" [link]="getPath('production')"></missing-control>
              <span *ngIf="producer.get('role').value"> (</span>
              <missing-control [control]="producer.get('role')" [link]="getPath('production')" scope="PRODUCER_ROLES" class="control-role"></missing-control>
              <span *ngIf="producer.get('role').value">)</span>
              <span>{{ isLast ? '' : ', '}}</span>
            </ng-template>
          </ng-container>
        </ul>
      </article>

      <article>
        <h5>
          Distributors
          <a mat-icon-button [routerLink]="getPath('production')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let distributor of form.stakeholders.get('distributor').controls; let isLast = last">
            <missing-control [control]="distributor.get('displayName')" [link]="getPath('production')"></missing-control>
            <ng-container *ngIf="distributor.get('countries').value.length">
              <span> (</span>
              <span *ngFor="let country of distributor.get('countries').value; let last = last">
                <span>{{ country | translateSlug: 'TERRITORIES' }}{{ last ? '' : ', '}}</span>
              </span>
              <span>)</span>
            </ng-container>
            <span>{{ isLast ? '' : ', '}}</span>
          </ng-container>
        </ul>
      </article>

      <article>
        <h5>
          International Sales
          <a mat-icon-button [routerLink]="getPath('production')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let saleAgent of form.stakeholders.get('salesAgent').controls; let isLast = last">
            <missing-control [control]="saleAgent.get('displayName')" [link]="getPath('production')"></missing-control>
            <ng-container *ngIf="saleAgent.get('countries').value.length">
              <span> (</span>
              <span *ngFor="let country of saleAgent.get('countries').value; let last = last">
                <span>{{ country | translateSlug: 'TERRITORIES' }}{{ last ? '' : ', '}}</span>
              </span>
              <span>)</span>
            </ng-container>
            <span>{{ isLast ? '' : ', '}}</span>
          </ng-container>
        </ul>
      </article>
    </section>

    <mat-divider></mat-divider>

    <section id="artistic-team">
      <h3>Artistic Team</h3>
      <article>
        <h5>
          Cast Members
          <a mat-icon-button [routerLink]="getPath('artistic')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ng-container *ngFor="let artist of form.cast.controls; let isLast = last">
          <li>
            <ng-container *ngIf="!artist.get('firstName').value || !artist.get('lastName').value else displayArtist">
              <a [routerLink]="getPath('artistic')" class="missing-control">
                Missing
              </a>
            </ng-container>
            <ng-template #displayArtist>
              <missing-control [control]="artist.get('firstName')" [link]="getPath('artistic')"></missing-control>
              <span>&nbsp;</span>
              <missing-control [control]="artist.get('lastName')" [link]="getPath('artistic')"></missing-control>
              <span>&nbsp;</span>
              <missing-control [control]="artist.get('filmography')" [link]="getPath('artistic')"></missing-control>
            </ng-template>
          </li>
        </ng-container>
      </article>

      <article>
        <h5>
          Crew Members
          <a mat-icon-button [routerLink]="getPath('artistic')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ng-container *ngFor="let crew of form.crew.controls; let isLast = last">
          <li>
            <ng-container *ngIf="!crew.get('firstName').value || !crew.get('lastName').value else displayCrew">
              <a [routerLink]="getPath('artistic')" class="missing-control">
                Missing
              </a>
            </ng-container>
            <ng-template #displayCrew>
              <missing-control [control]="crew.get('firstName')" [link]="getPath('artistic')"></missing-control>
              <span>&nbsp;</span>
              <missing-control [control]="crew.get('lastName')" [link]="getPath('artistic')"></missing-control>
              <span>&nbsp;</span>
              <strong>({{ crew.get('role').value | translateSlug: 'CREW_ROLES' }})&nbsp;</strong>
              <missing-control [control]="crew.get('filmography')" [link]="getPath('artistic')"></missing-control>
            </ng-template>
          </li>
        </ng-container>
      </article>
    </section>

    <mat-divider></mat-divider>

    <section id="reviews">
      <h3>Selections and Reviews</h3>
      <article>
        <h5>
          Festivals
          <a mat-icon-button [routerLink]="getPath('reviews')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let festivalPrize of form.prizes.controls">
            <li>
              <strong>Festivals </strong>
              <ng-container *ngIf="festivalPrizeHasNoValue(festivalPrize) else display">
                <a [routerLink]="getPath('reviews')" class="missing-control">
                  Missing
                </a>
              </ng-container>
              <ng-template #display>
                <missing-control [control]="festivalPrize.get('name')" [link]="getPath('reviews')">
                  <ng-template #content>{{ festivalPrize.get('name').value }}, </ng-template>
                </missing-control>
                <missing-control [control]="festivalPrize.get('prize')" [link]="getPath('reviews')">
                  <ng-template #content>{{ festivalPrize.get('prize').value }}, </ng-template>
                </missing-control>
                <missing-control [control]="festivalPrize.get('year')" [link]="getPath('reviews')">
                  <ng-template #content>{{ festivalPrize.get('year').value }}, </ng-template>
                </missing-control>
                <missing-control [control]="festivalPrize.get('premiere')" [link]="getPath('reviews')">
                  <ng-template let-premieres>
                    <ng-container *ngFor="let premiere of premieres; let isLast=last">
                      <span *ngIf="premiere">{{premiere | titlecase}} Premiere{{isLast? '' : ', '}}</span>
                    </ng-container>
                  </ng-template>
                </missing-control>
              </ng-template>
            </li>
          </ng-container>
        </ul>
      </article>
      <article>
        <h5>
          Film Reviews
          <a mat-icon-button [routerLink]="getPath('reviews')"><mat-icon svgIcon="pencil" color="primary"></mat-icon></a>
        </h5>
        <ul>
          <ng-container *ngFor="let review of form.review.controls">
            <li>
              <strong>Festivals </strong>
              <ng-container *ngIf="reviewHasNoValue(review) else display">
                <a [routerLink]="getPath('reviews')" class="missing-control">
                  Missing
                </a>
              </ng-container>
              <ng-template #display>
                <missing-control [control]="review.get('criticName')" [link]="getPath('reviews')">
                  <ng-template #content>{{ review.get('criticName').value }}, </ng-template>
                </missing-control>
                <missing-control [control]="review.get('journalName')" [link]="getPath('reviews')">
                  <ng-template #content>{{ review.get('journalName').value }}, </ng-template>
                </missing-control>
                <missing-control [control]="review.get('criticQuote')" [link]="getPath('reviews')">
                  <ng-template #content>{{ review.get('criticQuote').value }}, </ng-template>
                </missing-control>
                <missing-control [control]="review.get('revueLink')" [link]="getPath('reviews')">
                  <ng-template #content>{{ review.get('revueLink').value }}, </ng-template>
                </missing-control>
              </ng-template>
            </li>
          </ng-container>
        </ul>
      </article>
      <article>
        <h5></h5>
      </article>
      <article>
        <h5></h5>
      </article>
      <article>
        <h5></h5>
      </article>


    </section>

    <!-- Main card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Main Information</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('main')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-main [movie]="form" [link]="getPath('main')"></movie-summary-main>
        <movie-summary-country [movie]="form"  [link]="getPath('main')"></movie-summary-country>
        <movie-summary-information [movie]="form" [link]="getPath('main')"></movie-summary-information>
        <movie-summary-sales-cast [movie]="form" [link]="getPath('main')"></movie-summary-sales-cast>
        <movie-summary-festival-prizes [movie]="form" [link]="getPath('main')"></movie-summary-festival-prizes>
      </mat-card-content>
    </mat-card> -->

    <!-- Story card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Storyline Elements</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('synopsis')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-story [movie]="form" [link]="getPath('synopsis')"></movie-summary-story>
      </mat-card-content>
    </mat-card> -->

    <!-- Credit card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Credits</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('credits')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-credit [movie]="form" [link]="getPath('credits')"></movie-summary-credit>
      </mat-card-content>
    </mat-card> -->

    <!-- Budget card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Budget, Quota & Critics</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('budget')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-budget [movie]="form" [review]="form.review" [link]="getPath('budget')"></movie-summary-budget>
      </mat-card-content>
    </mat-card> -->

    <!-- Technical Information card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Technical Information</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('technical-info')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-technical-information [movie]="form" [link]="getPath('technical-info')"></movie-summary-technical-information>
      </mat-card-content>
    </mat-card> -->

    <!-- Images card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Promotional Images</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('images')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-image [form]="form" [link]="getPath('images')"></movie-summary-image>
      </mat-card-content>
    </mat-card> -->

    <!-- Files card -->
    <!-- <mat-card>
      <mat-card-header fxLayout="row" fxLayoutAlign="start center">
        <mat-card-title>Files & Links</mat-card-title>
        <a mat-icon-button [routerLink]="getPath('files&links')"><mat-icon svgIcon="pencil"></mat-icon></a>
      </mat-card-header>
      <mat-card-content>
        <movie-summary-file [promotional]="form.promotional" [link]="getPath('files&links')"></movie-summary-file>
      </mat-card-content>
    </mat-card> -->


    <!-- Submit -->
    <button test-id="submit" mat-flat-button color="accent" class="submit" (click)="submit()" [disabled]="isPublished$ | async">
      <span>Publish to Marketplace</span>
      <mat-icon svgIcon="arrow_forward"></mat-icon>
    </button>
  </ng-container>

</tunnel-page>
