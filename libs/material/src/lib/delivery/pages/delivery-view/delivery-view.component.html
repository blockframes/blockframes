
  <section *ngIf="(delivery$ | async) as delivery" fxLayout="row" fxLayoutGap="35px">
    <article class="progress-spinner-block" fxLayoutAlign="center start">
      <mat-card
        *ngIf="(progressionValue$ | async) as value; else empty"
        fxLayout="column"
        fxLayoutAlign="center center"
        class="mat-elevation-z0">
        <mat-progress-spinner
          class="spinner"
          color="warn"
          mode="determinate"
          [value]="value"
          diameter="180"
          strokeWidth="12">
        </mat-progress-spinner>
        <div class="progress-value">{{ value }} %</div>
        <p class="global-progression">Progression</p>
        <span class="spinner-text"><h5>Global delivery date :</h5></span>
        <p class="period-days">{{ delivery.dueDate | date: 'dd MMM yyyy' }}</p>
        <span fxLayoutAlign="center center">
          <mat-divider></mat-divider>
          <button mat-raised-button class="edit mat-elevation-z0" routerLink="../edit">
            <mat-icon color="primary">create</mat-icon> Edit delivery
          </button>
        </span>
      </mat-card>
      <ng-template #empty>
        <mat-card class="mat-elevation-z0" fxLayout="column" fxLayoutAlign="center center">
          <mat-progress-spinner
            class="spinner"
            color="warn"
            mode="determinate"
            [value]="0"
            diameter="180"
            strokeWidth="12"
          >
          </mat-progress-spinner>
          <div class="progress-value">0 %</div>
          <p class="global-progression">Progression</p>
          <span class="spinner-text"><h5>Global delivery date :</h5></span>
          <p class="period-days">{{ delivery.dueDate | date: 'dd MMM yyyy' }}</p>
          <span fxLayoutAlign="center center">
            <mat-divider></mat-divider>
            <button mat-raised-button class="edit mat-elevation-z0" routerLink="../edit">
              <mat-icon color="primary">create</mat-icon> Edit delivery
            </button>
          </span>
        </mat-card>
      </ng-template>
    </article>
    <article *ngIf="(movie$ | async) as movie" class="materials">
      <div class="materials" fxLayoutAlign="space-between center">
        <h2>{{ movie.title.original }}</h2>
        <span fxLayoutAlign="end">
          <material-filters class="filters"></material-filters>
          <material-actions
          [allChecked]="allChecked"
          [deliverySteps]="delivery.steps"
          (newState)="changeState($event)"
          (selectAllMaterials)="selectAllMaterials()">
          </material-actions>
        </span>
      </div>
      <div *ngFor="let category of (materials$ | async | keyvalue)" fxLayout="column">
        <h3>{{ category.key | uppercase }}</h3>
        <div *ngFor="let material of category.value">
          <delivery-view-item
            [isChecked]="allChecked"
            [material]="material"
            (isSelected)="selectMaterial($event, material.id)"
          ></delivery-view-item>
        </div>
      </div>
    </article>
  </section>
