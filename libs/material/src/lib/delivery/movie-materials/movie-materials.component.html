<div *ngIf="(movie$ | async) as movie" class="container">
  <section fxLayout="row" fxLayoutGap="5%">
    <article class="progress-spinner-block" fxLayoutAlign="center start">
      <mat-card
        *ngIf="(progressionValue$ | async) as value; else empty"
        fxLayout="column"
        fxLayoutAlign="center center"
        class="mat-elevation-z6"
      >
        <mat-progress-spinner
          class="spinner"
          color="warn"
          mode="determinate"
          [value]="value"
          diameter="200"
          strokeWidth="13"
        >
        </mat-progress-spinner>
        <div class="progress-value">{{ value }} %</div>
        <h5>Global progression</h5>
        <p class="spinner-text"><i>La progression en %age des deliveries de la movie</i></p>
      </mat-card>
      <ng-template #empty>
        <mat-card fxLayout="column" fxLayoutAlign="center center">
          <mat-progress-spinner
            class="spinner"
            color="warn"
            mode="determinate"
            value="0"
            diameter="200"
            strokeWidth="15"
          >
          </mat-progress-spinner>
          <div class="progress-value">
            0 %
          </div>
          <h5>Global progression</h5>
          <p class="spinner-text"><i>La progression en %age des deliveries de la movie</i></p>
        </mat-card>
      </ng-template>
    </article>
    <article class="materials" fxLayout="column">
      <h2>{{ movie.title }}</h2>
      <div *ngFor="let category of (materials$ | async | keyvalue)">
        <h3>{{ category.key | uppercase }}</h3>
        <mat-card *ngFor="let material of category.value" class="materials-block mat-elevation-z6">
          <span
            ><h4 mat-line>
              <mat-checkbox
                [(ngModel)]="material.delivered"
                (click)="deliveredToggle(material, movie.id)"
                ><b>{{ material.value }}</b></mat-checkbox
              >
            </h4></span
          >
          <p mat-line class="description-text">
            <i>{{ material.description }}</i>
          </p>
        </mat-card>
      </div>
    </article>
  </section>
</div>
