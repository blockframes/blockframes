<form [availsFilter]="availsForm"></form>

<h2>Available Dates</h2>
<ng-container *ngIf="org$ | async as org">
  <p>
    Select the time window you're interested in to add it to your Selection. For periods that are not licensed, feel free to
    <a [routerLink]="['/c/o/marketplace/organization', org.id, 'member']">contact {{ org | orgName }}</a>.
  </p>

</ng-container>

<section class="surface" fxLayout="column">
  <!-- CALENDAR LEGEND -->
  <ul>
    <li>
      <svg viewBox="0 0 100 100" width="10px" height="10px">
        <rect fill="#7795ff" x="0" y="0" width="100" height="100" rx="10" ry="10" />
      </svg>
      <span class="mat-caption">Available</span>
    </li>
    <li>
      <svg viewBox="0 0 100 100" width="10px" height="10px">
        <rect fill="#9ca3c4" x="0" y="0" width="100" height="100" rx="10" ry="10" />
      </svg>
      <span class="mat-caption">Sold</span>
    </li>
    <li>
      <svg viewBox="0 0 100 100" width="10px" height="10px">
        <rect fill="#d3ddff" x="0" y="0" width="100" height="100" rx="10" ry="10" />
      </svg>
      <span class="mat-caption">Already Selected</span>
    </li>
  </ul>

  <ng-container *ngIf="availabilities$ | async as availabilities; else loading">
    <avails-calendar
      fxFlexAlign="center"
      fxFlexAlign.lt-md="start"
      [availableMarkers]="availabilities.available"
      [soldMarkers]="availabilities.sold"
      [inSelectionMarkers]="availabilities.inBucket"
      [selectedMarker]="availabilities.selected"
      (selected)="selected($event)"
    ></avails-calendar>
  </ng-container>
  <ng-template #loading>
    <mat-spinner></mat-spinner>
  </ng-template>

  <div *ngIf="(status$ | async) === 'INVALID'" class="overlay" fxLayoutAlign="center center">
    <article class="mat-body-2">
      Please fill in Avail Search Criteria section to show results on the Calendar.
    </article>
  </div>
</section>
