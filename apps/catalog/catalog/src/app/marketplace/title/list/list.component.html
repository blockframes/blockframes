<list-page [items]="movies$ | async">

  <!-- App Bar Search -->
  <list-page-app-bar>
    <form class="app-bar" [formGroup]="searchForm">
      <input type="text" formControlName="query" [value]="searchForm.query.value">
    </form>
  </list-page-app-bar>

  <!-- SORT -->
  <!--   <list-page-sort>

    <mat-form-field class="sort">
      <mat-label>Sort by</mat-label>
      <mat-select [formControl]="sortByControl">
        <mat-option *ngFor="let option of sortOptions" [value]="option">
          {{option}}
        </mat-option>
      </mat-select>
    </mat-form-field>

  </list-page-sort> -->

  <!-- SEARCH BAR -->

  <list-page-search>
    <form [formGroup]="searchForm">
      <mat-form-field appearance="outline">
        <mat-label>Search for titles, directors, keywords, ...</mat-label>
        <mat-icon matPrefix svgIcon="magnifying_glasses"></mat-icon>
        <input matInput type="text" formControlName="query" [value]="searchForm.get('query').value">
      </mat-form-field>
    </form>
  </list-page-search>

  <!-- FILTERS (ng-content) -->
  <list-filter>


    <!-- TODO issue#2576 -->
    <ng-template filter label="Library / Line-up" [form]="searchForm.storeType">
      <static-check-boxes fxLayout="row" fxLayoutAlign="space-between" [form]="searchForm.storeType" scope="storeType" type="constant"></static-check-boxes>
    </ng-template>

    <ng-template filter label="Genres" [form]="searchForm.genres">
      <chips-autocomplete [form]="searchForm.genres" scope="genres" type="constant"></chips-autocomplete>
    </ng-template>

    <ng-template filter label="Country of Origin" [form]="searchForm.originCountries">
      <chips-autocomplete [form]="searchForm.originCountries" placeholder="Country of Origin" scope="TERRITORIES" type="model">
      </chips-autocomplete>
    </ng-template>

    <ng-template filter label="Language & Version" [form]="searchForm.languages">
      <title-language-filter [languagesFilterForm]="searchForm.languages"></title-language-filter>
    </ng-template>

    <ng-template filter label="Production Status" [form]="searchForm.productionStatus">
      <static-check-boxes fxLayout="column" [form]="searchForm.productionStatus" scope="productionStatus"
        type="constant"></static-check-boxes>
    </ng-template>

    <ng-template filter label="Minimum Budget" [form]="searchForm.minBudget">
      <filter-budget fxLayout="column" [form]="searchForm.minBudget"></filter-budget>
    </ng-template>

    <!-- TODO issue#2576 -->
    <!-- <ng-template filter label="AVAILS" section>
      <p class="mat-caption">You need to fill in Terms, Territory and Media before applying the Avails filter</p>
    </ng-template> -->

    <!-- TODO 2562-->
    <!--    <ng-template filter label="Term">
      <p>TODO</p>
    </ng-template> -->

    <!-- TODO 2562-->
    <!--  <ng-template filter label="Territory">
      <p>TODO</p>
    </ng-template> -->

    <!-- TODO 2562-->
    <!--    <ng-template filter label="Media">
      <p>TODO</p>
    </ng-template> -->

    <!-- TODO 2562-->
    <!--   <ng-template filter label="Exclusivity">
      <p>TODO</p>
    </ng-template> -->

    <!-- TODO issue#2576 -->
    <!--     <ng-template filter label="" section>
      <button mat-stroked-button color="primary">Apply Avails Filter</button>
    </ng-template> -->
  </list-filter>

  <button mat-icon-button (click)="clear()" matTooltip="Clear all filters">
    <mat-icon svgIcon="refresh_filters"></mat-icon>
  </button>

  <!-- TITLE CARD -->
  <ng-template listPageCard let-title>
    <movie-card [movie]="title" [link]="['/c/o/marketplace/title',  title.id]" size="poster">
    </movie-card>
  </ng-template>

  <ng-template listPageEmpty *ngIf="loading$.value">
    <div class="loading">
      <mat-spinner color="primary"></mat-spinner>
    </div>
  </ng-template>

  <list-page-progress [value]="hitsViewed / nbHits * 100" (loadMore)="loadMore()" *ngIf="!loading$.value">
    You've viewed {{ hitsViewed }} of {{ nbHits }} titles
  </list-page-progress>

</list-page>
