<section>
  <article fxLayout="row" fxLayoutAlign="start center">
    <h1>Wishlist</h1>
  </article>
  <article *ngIf="dataSource$ | async as dataSource; else noWishlist">
    <table mat-table [dataSource]="dataSource">
      <!-- Movie -->
      <ng-container matColumnDef="movie">
        <th mat-header-cell *matHeaderCellDef>International title</th>
        <td mat-cell *matCellDef="let element" class="bf-strong">
          {{ element.main.title.international }}
        </td>
      </ng-container>

      <!-- Director -->
      <ng-container matColumnDef="director">
        <th mat-header-cell *matHeaderCellDef>Director</th>
        <td mat-cell *matCellDef="let element">
          <span *ngFor="let director of element.main.directors | slice: 0:2; let isLast = last">
            {{ director.firstName | titlecase }} {{ director.lastName | titlecase }}{{ isLast ? '' : ', ' }}
          </span>
        </td>
      </ng-container>

      <!-- Production Status -->
      <ng-container matColumnDef="productionStatus">
        <th mat-header-cell *matHeaderCellDef>Production status</th>
        <td mat-cell *matCellDef="let element">{{ element.main.status | translateSlug: 'MOVIE_STATUS' }}</td>
      </ng-container>

      <!-- Origin Country -->
      <ng-container matColumnDef="originCountry">
        <th mat-header-cell *matHeaderCellDef>Country of origin</th>
        <td mat-cell *matCellDef="let element">
          <span *ngFor="let country of element.main.originCountries | slice: 0:2; let isLast = last">
            {{ country | translateSlug: 'TERRITORIES' }}{{ isLast ? '' : ', ' }}
          </span>
        </td>
      </ng-container>

      <!-- Total Run Time -->
      <ng-container matColumnDef="totalRunTime">
        <th mat-header-cell *matHeaderCellDef>Running time</th>
        <td mat-cell *matCellDef="let element">
          <ng-container *ngIf="element.main.totalRunTime; else noLength">{{ element.main.totalRunTime }} min
          </ng-container>
          <ng-template #noLength>TBC</ng-template>
        </td>
      </ng-container>

      <!-- Action -->
      <ng-container matColumnDef="delete">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button test-id="remove" mat-icon-button (click)="remove(element, $event)">
            <mat-icon svgIcon="trash"></mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
      <tr mat-row *matRowDef="let row; columns: columnsToDisplay" (click)="redirectToMovie(row.id)"></tr>
    </table>

  </article>
  <ng-template #noWishlist>
    <article fxLayout="column" fxLayoutAlign="center center">
      <p>Your wishlist is empty.</p>
      <img asset="no_wishlist.webp" alt="No whislist image">
    </article>
  </ng-template>
</section>