<ng-container *ngIf="movie$ | async as movie">
  <title-marketplace-shell [routes]="navLinks">
    <movie-header [movie]="movie">

      <movie-header-cta fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="32px">
        <ng-container *ngFor="let org of orgs$ | async">
          <org-chip [org]="org"></org-chip>
          <div class="cta-button" fxFlex fxLayout fxLayoutAlign="space-between start" fxLayout.lt-md="column" fxLayoutGap.lt-md="16px">
            <a mat-flat-button color="primary" [href]="'mailto:' + org.email">
              <span>{{ org.activity === 'intlSales' ? 'Contact Sales Agent' : 'Contact' }}</span>
              <mat-icon svgIcon="arrow_forward"></mat-icon>
            </a>
            <ng-container *ngIf="(eventId$ | async) as eventId">
              <a ongoing-event-button [routerLink]="['/c/o/marketplace/event', eventId]">Ongoing Screening</a>
            </ng-container>
          </div>
        </ng-container>
      </movie-header-cta>

      <movie-header-actions fxLayout.lt-sm="column" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="24px">
        <wishlist-button [movieId]="movie.id"></wishlist-button>
        <movie-promotional-links [movie]="movie" [links]="promoLinks"></movie-promotional-links>
      </movie-header-actions>
    </movie-header>

    <ng-container *ngIf="event$ |  async as event">
      <event-view [event]="event">
        <ng-container [ngSwitch]="event.type">
    
          <!-- Screening -->
          <section class="screening" *ngSwitchCase="'screening'">
            <movie-header *ngIf="event.movie" [movie]="event.movie" [showBackArrow]="false">
              <movie-header-preferences>
                <p>{{ event.movie.synopsis }}</p>
                <org-chip [org]="event.org"></org-chip>
              </movie-header-preferences>
              <movie-header-cta>
                <a mat-flat-button color="primary" [routerLink]="['../../title', event.movie.id]">
                  More Details
                </a>
              </movie-header-cta>
            </movie-header>
          </section>
    
          <!-- Meeting -->
          <section class="meeting" fxLayout="column" fxLayoutGap="40px" *ngSwitchCase="'meeting'">
            <article fxLayout="column" fxLayoutGap="16px" class="organized-by">
              <h2>Organized by</h2>
              <div fxLayout fxLayoutAlign="start center" fxLayoutGap="16px">
                <a matRipple [routerLink]="['/c/o/marketplace/organization', event.org.id]">
                  <img asset="empty_organization.svg" type="logo" alt="Organization Logo">
                </a>
                <div fxLayout="column" fxLayoutGap="4px">
                  <h6><a [routerLink]="['/c/o/marketplace/organization', event.org.id]">{{ event.org | orgName }}</a></h6>
                  <ng-container *ngIf="event.organizedBy as user">
                    <span>{{ user | displayName }}{{ user | displayPosition }}</span>
                  </ng-container>
                </div>
              </div>
              <ng-container *ngIf="!!event.meta.description">
                <h5>Description</h5>
                <p>{{ event.meta.description }}</p>
              </ng-container>
            </article>
          </section>
    
        </ng-container>
      </event-view>
    </ng-container>
    
    
  </title-marketplace-shell>
</ng-container>
