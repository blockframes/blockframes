<!-- TODO(#838): Use HostBinding instead of root div -->
<div test-id="content">
  <header fxLayout="column" fxLayoutAlign="center start" fxLayoutAlign.xs="center center" fxLayoutGap="20px">
    <h2>Archipel Content</h2>
    <h1>The only marketplace offering package deals</h1>
    <p>for TV, VOD and ancillary rights</p>
    <a mat-flat-button color="accent" test-id="library" routerLink="../title">View the Library</a>
  </header>

  <section fxLayout="column" fxLayoutAlign="start center">
    <ng-container *ngFor="let section of moviesBySections$ | async; let i = index">
      <!-- We want by every iteration of the keys array that the text switches side-->
      <article [fxLayout]="layout(i)" fxLayout.lt-md="column" fxLayoutAlign="center start">
        <aside fxLayout="column" [fxLayoutAlign]="alignment(i)" fxLayoutAlign.lt-md="center center" fxLayoutGap="20px">
          <h1>{{ section.title }}</h1>
          <p>{{ section.subline}} </p>
          <a mat-flat-button test-id="seeMore1" color="accent" routerLink="../title">See more</a>
        </aside>
        <mat-carousel test-id="mat-carousel1" proportion="50" [hideArrows]="true" [hideIndicators]="true">
          <!-- We only want to use the first image in the promotinalElements.images array-->
            <mat-carousel-slide #matCarouselSlide *ngFor="let movie of section.movies" [image]="getBanner(movie)">
              <div
                fxLayout="column"
                fxLayoutAlign="end start"
                class="black-bg-opacity-30 overlay"
                [routerLink]="['title', movie.id]">
                <ng-container *ngIf="(toggle$(movie.id) | async); else notAdded">
                  <button test-id="heart-icon" mat-icon-button (click)="removeFromWishlist(movie, $event)">
                    <mat-icon svgIcon="heart_fill" color="accent"></mat-icon>
                  </button>
                </ng-container>
                <ng-template #notAdded>
                  <button test-id="heart-icon" mat-icon-button (click)="addToWishlist(movie, $event)">
                    <mat-icon svgIcon="heart_outline"></mat-icon>
                  </button>
                </ng-template>
                <div fxLayout="column" fxLayoutAlign="center start" fxLayoutGap="5px" class="informations">
                  <h3 mat-button color="primary">{{ movie.main.title.international }}</h3>
                  <div>
                    <span class="mat-body-2" *ngFor="let director of movie.main.directors; let isLast=last">
                      {{ director.firstName }} {{ director.lastName }}{{isLast ? '' : ', '}}
                    </span>
                  </div>
                  <span class="mat-caption">{{ getMainInfo(movie) }}</span>
                  <span class="mat-caption" *ngFor="let salesAgent of movie.main.stakeholders.salesAgent; let isLast=last">
                    {{ salesAgent.displayName }}{{isLast ? '' : ', '}}
                  </span>
                </div>
              </div>
            </mat-carousel-slide>
        </mat-carousel>
      </article>
    </ng-container>
  </section>
</div>
