<ng-container *ngIf="(titles$ | async) as titles; else loading">
  <ng-container *ngIf="(filter.value !== 'all' || titles.length); else empty">
    <header fxLayout="row" fxLayoutAlign="space-between center" class="import">
      <h1>My Projects</h1>
      <div fxLayoutGap="24px">
        <a mat-stroked-button color="primary" routerLink="../import">
          <mat-icon svgIcon="excel"></mat-icon>
          <span>Import Movies</span>
        </a>
        <a mat-mini-fab color="primary" routerLink="lobby" matTooltip="Add a new title">
          <mat-icon svgIcon="add"></mat-icon>
        </a>
      </div>
    </header>

    <nav mat-tab-nav-bar fxLayout="row" fxLayoutAlign="space-between end">
      <button mat-tab-link (click)="applyFilter('all')" [active]="filter.value === 'all'">All Projects</button>
      <button mat-tab-link (click)="applyFilter('draft')" [active]="filter.value === 'draft'">Draft</button>
      <button mat-tab-link (click)="applyFilter('ongoing')" [active]="filter.value === 'ongoing'">On Going</button>
      <button mat-tab-link (click)="applyFilter('achieved')" [active]="filter.value === 'achieved'">Achieved</button>
    </nav>
    
    <mat-card>
      <bf-table-filter [source]="titles" [columns]="columns" [initialColumns]="initialColumns" showFilter showPaginator clickable
        (rowClick)="goToTitle($event)">
        <ng-template colRef="title" let-title><b>{{ title.international }}</b></ng-template>
        <ng-template colRef="productionStatus" let-prod>{{ prod | titlecase }}</ng-template>
        <ng-template colRef="campaign.cap" let-cap let-movie="item">
          {{ cap ? (cap | currency : movie.campaign.currency : 'symbol' : '1.0-0') : '-' }}
        </ng-template>
        <ng-template colRef="campaign.received" let-received let-movie="item">
          {{ received ? (received | currency : movie.campaign.currency : 'symbol' : '1.0-0') : '-' }}
        </ng-template>
      </bf-table-filter>
    </mat-card>
  </ng-container>

</ng-container>

<ng-template #loading>
  <mat-spinner></mat-spinner>
</ng-template>

<ng-template #empty>
  <section fxLayout="column" fxLayoutAlign="center center">
    <dashboard-no-title></dashboard-no-title>
    <article fxLayout="row" fxLayout.lt-md="column" fxLayoutAlign="center" fxLayoutGap="24px">
      <mat-card class="no-title-card" fxLayout="column" fxLayoutalign="center center">
        <img asset="add_title.webp" alt="Add title image">
        <a routerLink="lobby" mat-button color="primary">Add one title</a>
      </mat-card>
      <mat-card class="no-title-card" fxLayout="column">
        <img asset="add_files.webp" alt="Upload files image">
        <a routerLink="../import" mat-button color="primary">Import your titles in bulk</a>
      </mat-card>
    </article>
  </section>
</ng-template>
